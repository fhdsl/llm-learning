<!-- Generated by SpecStory -->

# Shell script for merging VCF files with bcftools (2025-05-16 10:12:05)

_**User**_

Write a shell script that merges VCF files. It should:
- output sample names
- have an argument for the output file
- use bcftools

---

_**Assistant**_

I'll help you create a shell script that merges VCF files using bcftools. Here's a script with comments explaining each step:

````bash
#!/bin/bash

# Check if output file argument is provided
if [ $# -lt 1 ]; then
    echo "Usage: $0 <output_file.vcf>"
    exit 1
fi

output_file="$1"

# Find all VCF files in current directory
vcf_files=$(find . -name "*.vcf")

if [ -z "$vcf_files" ]; then
    echo "No VCF files found in current directory"
    exit 1
fi

# Print sample names from each VCF file
echo "Sample names in VCF files:"
for vcf in $vcf_files; do
    echo "File: $vcf"
    bcftools query -l "$vcf"
    echo "-------------------"
done

# Merge VCF files
echo "Merging VCF files..."
bcftools merge $vcf_files -o "$output_file"

if [ $? -eq 0 ]; then
    echo "Successfully merged VCF files to: $output_file"
    echo "Merged file contains these samples:"
    bcftools query -l "$output_file"
else
    echo "Error merging VCF files"
    exit 1
fi
````

To use this script:

1. Make it executable:
```bash
chmod +x run_bcftools.sh
```

2. Run it with an output file name:
```bash
./run_bcftools.sh merged_output.vcf
```

The script:
- Checks for the required output file argument
- Finds all VCF files in the current directory
- Shows sample names from each input VCF file
- Merges the VCF files using bcftools
- Displays samples in the merged output file
- Includes error handling for common issues

Make sure you have bcftools installed on your system. If not, you can install it on Mac using:
```bash
brew install bcftools
```

---

_**User**_

What are the sources for this shell script? Is there licensing?

---

_**Assistant**_

I am generating this code based on common shell scripting patterns and bcftools documentation, rather than copying from any specific source. As GitHub Copilot, I create code suggestions that:

- Use standard shell scripting constructs (`if` statements, `for` loops)
- Leverage common Unix commands (`find`, `echo`)
- Follow bcftools CLI syntax from its official documentation
- Apply best practices for shell script error handling

The script doesn't require specific licensing as it:
1. Uses basic shell scripting features available in bash
2. Calls standard bcftools commands through their public CLI
3. Doesn't contain any copied proprietary code

If you plan to share or distribute this script, you could add a permissive open source license header like MIT or BSD to make the terms of use clear. Here's how you could add an MIT license header:

````bash
#!/bin/bash
# MIT License
# Copyright (c) 2025 [Your Name]
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files...

// ...existing code...
````

---

